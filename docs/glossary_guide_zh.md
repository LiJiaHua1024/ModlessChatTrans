## 术语表功能指南 (Glossary Feature Guide)

**简介**

“术语表”功能允许您创建自定义翻译规则，以确保特定术语、常用语或包含动态信息（如玩家名称）的消息能够按照您的意愿进行翻译。您可以在“术语表”窗口中添加、修改和删除这些规则。

**打开术语表窗口**

在主界面，通过“更多设置”->“术语表”路径打开此功能窗口。

**界面概览**

打开“术语表”窗口后，您会看到：

1. **输入区域:**
    * **源术语 (Source Term):** 输入您想要匹配的原始文本模式。
    * **目标术语 (Target Term):** 输入对应的翻译结果。
    * **添加/更新术语 (Add/Update Term):** 用于添加新规则或保存对现有规则的修改。
2. **术语规则列表 (Glossary Rules):** 显示您已定义的所有规则。您可以点击列表中的规则来选中它，选中的规则会自动填充到上方的输入框中。
3. **操作按钮区域:**
    * **删除选中项 (Delete Selected):** 删除在列表中选中的规则。
    * **保存术语表并关闭 (Save Glossary and Close):** 保存所有更改并关闭此窗口。

**如何添加和使用翻译规则**

**1. 添加精确匹配规则**

这是最简单的规则类型，用于直接替换完全相同的文本。

* **操作:**
    1. 在“**源术语**”输入框中，输入您想要替换的**完整**原始文本（例如 `gg`）。
    2. 在“**目标术语**”输入框中，输入您希望显示的翻译文本（例如 `玩的不错`）。
    3. 点击“**添加/更新术语**”按钮。
* **效果:** 当程序接收到的消息**完全**是“gg”时（忽略首尾空格），它将被翻译为“玩的不错”。

**2. 使用变量处理动态内容 (`{{变量名}}`)**

当原始消息中包含不固定的部分（如用户名、物品名等）时，您需要使用变量。

* **语法:**
    * 在“**源术语**”输入框中使用 `{{变量名}}` 来标记需要匹配和捕获的动态部分。
    * 变量名可以包含**字母、数字、下划线 (`_`) 和连字符 (`-`)**。
    * 在“**目标术语**”输入框中使用**相同**的 `{{变量名}}` 来插入之前捕获到的内容。
* **操作与示例:**
    * **示例 1：玩家加入**
        1. 源术语: `{{player}} joined the game.`
        2. 目标术语: `{{player}} 加入了游戏。`
        3. 点击“添加/更新术语”。

        * 效果: 输入 `"Alice joined the game."` 会被翻译成 `"Alice 加入了游戏。"`。系统会自动识别 `player` 对应的内容是 "
          Alice"。
    * **示例 2：多个变量**
        1. 源术语: `{{actor}} gave {{item}} to {{receiver}}.`
        2. 目标术语: `{{actor}} 把 {{item}} 给了 {{receiver}}。`
        3. 点击“添加/更新术语”。

        * 效果: `"Bob gave an apple to Charlie."` -> `"Bob 把 an apple 给了 Charlie。"`
    * **示例 3：变量顺序调整或丢弃**
        1. 源术语: `[{{channel}}] {{user}}: {{message}}`
        2. 目标术语: `{{user}} 说: {{message}}` (这里 `channel` 变量被丢弃了)
        3. 点击“添加/更新术语”。

        * 效果: `"[Global] Eve: Hi!"` -> `"Eve 说: Hi!"`
        * **重要:** “目标术语”中使用的所有 `{{变量}}` **必须**在对应的“源术语”中也存在。

**3. 处理重复变量**

如果在“**源术语**”中多次使用了**相同名称**的变量（例如 `{{name}} ... {{name}}`），那么规则匹配时，原始消息中对应这两个位置的文本
**必须完全相同**。

* **示例:**
    1. 源术语: `{{admin}} kicked {{admin}} from the server.`
    2. 目标术语: `管理员 {{admin}} 把自己踢出了服务器。`
    3. 点击“添加/更新术语”。

    * 效果:
        * `"Operator kicked Operator from the server."` -> 匹配成功，翻译为 `"管理员 Operator 把自己踢出了服务器。"`
        * `"Admin kicked User from the server."` -> **不匹配**此规则，因为第一个 `{{admin}}` 捕获的是 "Admin"，第二个是 "
          User"，两者不同。

**4. 高级技巧：使用正则表达式限制变量格式 (`{{变量名:正则表达式}}`)**

此功能允许您在“**源术语**”中，为变量指定一个精确的匹配模式（格式要求），而不是匹配任意文本。这在需要确保变量是数字、特定格式代码等情况下很有用。

* **语法:** 在“**源术语**”的变量名后紧跟**英文冒号 (`:`)** 和一个正则表达式模式。
    * **请特别注意：** 必须使用**半角**的英文冒号 `:`，而不是全角的中文冒号 `：`！错误的冒号将导致规则无法按预期工作。
* **什么是正则表达式?**
    * 是一种用于描述文本模式的特殊“代码”或“公式”。它能帮你更精确地匹配你想要的文本格式。
    * 如果你不熟悉正则表达式，可以暂时忽略此高级功能，或者通过以下资源学习：
        * **Python 官方 `re` 模块文档:
          ** [https://docs.python.org/3/library/re.html](https://docs.python.org/3/library/re.html)
        * **菜鸟教程 - 正则表达式 (中文入门):
          ** [https://www.runoob.com/regexp/regexp-tutorial.html](https://www.runoob.com/regexp/regexp-tutorial.html)
    * 简单示例：
        * `\d+` : 要求匹配一个或多个数字。
        * `[a-zA-Z]+`: 要求匹配一个或多个英文字母。
* **示例：确保玩家 ID 是数字**
    1. 源术语: `Player {{player_id:\d+}} disconnected.` (**注意:** 这里 `player_id` 后是英文冒号 `:`)
    2. 目标术语: `玩家 {{player_id}} 已断开连接。`
    3. 点击“添加/更新术语”。

    * 效果:
        * `"Player 12345 disconnected."` -> 匹配成功 (因为 "12345" 符合 `\d+` )，翻译为 `"玩家 12345 已断开连接。"`
        * `"Player abc disconnected."` -> **不匹配**此规则 (因为 "abc" 不符合 `\d+` )。

**管理现有规则**

* **查看:** 所有规则都显示在“**术语规则列表**”中，格式为 `"源术语" → "目标术语"`。
* **选中与取消选中:**
    * **单击**列表中的任意一条规则即可**选中**它。选中的规则会高亮显示，“删除选中项”按钮会变为可用，同时该规则的“源术语”和“目标术语”会
      **自动填充**到上方的输入框中。
    * 再次**单击**当前已选中的规则，即可**取消选中**（反选）。取消选中后，规则不再高亮，“删除选中项”按钮变回不可用。
* **修改:**
    1. 单击选中您想修改的规则，规则内容会自动填入上方输入框。
    2. 直接在输入框中修改“源术语”或“目标术语”。
    3. 点击“**添加/更新术语**”按钮。
        * 如果您**没有**修改输入框中的“源术语”，系统将只更新这条规则的“目标术语”。
        * 如果您**修改了**输入框中的“源术语”，系统将尝试用新的“源术语”和“目标术语”**替换**
          掉您原来选中的那条规则（相当于重命名了源术语）。如果新的源术语与其他现有规则冲突，会提示您确认是否覆盖。
* **删除:**
    1. 单击选中您想删除的规则。
    2. 点击“**删除选中项**”按钮。
    3. 规则将从列表中移除。

**保存更改**

完成所有添加、修改或删除操作后，**务必**点击“**保存术语表并关闭**”按钮来保存您的所有工作并关闭窗口。否则，您在本次窗口中所做的更改将会丢失。