## **术语表功能指南 (Glossary Feature Guide)**

**简介**

“术语表”功能允许您创建自定义翻译规则，以确保特定术语、常用语或包含动态信息（如玩家名称）的结构化消息，都能按照您的意愿进行精确翻译。此功能通过两种方式提升翻译质量：

1. **关键词注入 (无变量):** 对于普通聊天消息，可以识别出您定义的特定术语，并“指导”大语言模型（LLM）在翻译时使用您指定的译文，从而保证术语的统一性和准确性。
2. **模板匹配 (带变量):** 对于格式固定的消息（如系统通知），可以精确解析并按预设格式翻译。

**访问术语表**

在程序主界面的左侧导航栏中，点击“**术语表**”图标，即可进入术语管理界面。

**界面概览**

术语管理界面分为几个主要区域：

1. **输入区域:**
    * **源术语 (Source Term):** 输入您想要匹配的原始文本模式或关键词。
    * **目标术语 (Target Term):** 输入对应的翻译结果。
2. **操作按钮:**
    * **添加/更新术语 (Add/Update Term):** 用于添加新规则或保存对现有规则的修改。
    * **清空输入 (Clear Input):** 清除上方“源术语”和“目标术语”输入框中的内容。
3. **术语规则列表:**
    * 以列表形式显示您已定义的所有规则。您可以点击列表中的规则来选中它。
4. **列表管理按钮:**
    * **删除选中术语 (Delete Selected Term):** 删除在列表中选中的规则。
    * **清空术语 (Clear Glossary):** 删除列表中的所有术语规则。

**如何添加和使用翻译规则**

术语表支持两种核心类型的规则。**对于绝大多数用户来说，使用类型一就足够满足日常需求。**

### **类型一：添加关键词以优化LLM翻译 (无变量)**

这是最常用、最简单，也是我们推荐给大多数用户的规则类型。它用于告诉翻译引擎：“当你在任何消息中看到这个词或短语时，请务必将它翻译成我指定的结果。”

* 重要前提:  
  此功能的工作原理是为LLM提供上下文指导，因此必须配合支持LLM的翻译服务使用。如果您使用的是传统的翻译引擎（如谷歌翻译、DeepL等），此类型规则将不会生效。
* 工作原理:  
  当一条消息被发送给LLM进行翻译时，程序会首先检查消息中是否包含您在此处定义的任何“源术语”。如果包含，程序会将这些“术语”及其“译文”一并发送给LLM作为强制性翻译指令。这并非简单的文本替换，而是为LLM提供了准确的上下文，使其翻译结果更符合您的预期。
* **操作:**
    1. 在`源术语`输入框中，输入一个独立的单词或短语 (例如 `gg`)。
    2. 在`目标术语`输入框中，输入其对应的标准翻译 (例如 `玩得不错`)。
    3. 点击`添加/更新术语`按钮。
* **效果:**
    * **原始消息:** "That was a fun match, gg"
    * **翻译过程:** 程序识别出消息中的`gg`。它会向LLM发送指令：“请翻译‘That was a fun match, gg’，并确保将‘gg’翻译为‘玩得不错’。”
    * **最终结果:** “那是一场有趣的比赛，玩得不错。”

### **类型二：使用模板和变量处理动态内容 (高级功能)**

**此功能为高级用户准备。** 当您需要处理的原始消息结构固定，但其中包含用户名、物品名等不固定的部分时（常见于游戏内的系统提示），您可以使用带变量的模板匹配规则。
**此类型规则只有在整条消息完全匹配模板时才会触发。**

* **语法:**
    * 在`源术语`输入框中使用 `{{变量名}}` 来标记需要匹配和捕获的动态部分。
    * 变量名可以包含**字母、数字、下划线 (\_) 和连字符 (-)**。
    * 在`目标术语`输入框中使用**相同**的 `{{变量名}}` 来插入之前捕获到的内容。
* **操作与示例:**
    * **示例 1：玩家加入**
        1. 源术语: `{{player}} joined the game.`
        2. 目标术语: `{{player}} 加入了游戏。`
        3. 点击`添加/更新术语`。

        * **效果:** 输入 "Alice joined the game." 会被直接翻译成 "Alice 加入了游戏。"。
    * **示例 2：多个变量**
        1. 源术语: `{{actor}} gave {{item}} to {{receiver}}.`
        2. 目标术语: `{{actor}} 把 {{item}} 给了 {{receiver}}。`

        * **效果:** "Bob gave an apple to Charlie." -> "Bob 把 an apple 给了 Charlie。"
    * **示例 3：变量顺序调整或丢弃**
        1. 源术语: `[{{channel}}] {{user}}: {{message}}`
        2. 目标术语: `{{user}} 说: {{message}}` (这里 channel 变量被丢弃了)

        * **效果:** "[Global] Eve: Hi!" -> "Eve 说: Hi!"
        * **重要:** “目标术语”中使用的所有 `{{变量}}` **必须**在对应的“源术语”中也存在。

**模板匹配的高级技巧**

以下技巧仅适用于**类型二（带变量的模板）**规则。

**1. 处理重复变量**

如果在`源术语`中多次使用了**相同名称**的变量（例如 `{{name}} ... {{name}}`），那么规则匹配时，原始消息中对应这两个位置的文本
**必须完全相同**。

* **示例:**
    1. 源术语: `{{admin}} kicked {{admin}} from the server.`
    2. 目标术语: `管理员 {{admin}} 把自己踢出了服务器。`

    * **效果:**
        * "Operator kicked Operator from the server." -> 匹配成功，翻译为 "管理员 Operator 把自己踢出了服务器。"
        * "Admin kicked User from the server." -> **不匹配**此规则。原因是，第一个 `{{admin}}` 捕获的内容是 "Admin"，而第二个
          `{{admin}}` 所在位置的文本是 "User"，两者内容不同。

**2. 使用正则表达式限制变量格式 (`{{变量名:正则表达式}}`)**

此功能允许您为变量指定一个精确的匹配模式，而不是匹配任意文本。

* **语法:** 在`源术语`的变量名后紧跟**英文冒号 (:)** 和一个正则表达式模式。
    * **请特别注意：** 必须使用**半角**的英文冒号 `:`，而不是全角的中文冒号 `：`！
* **什么是正则表达式?**
    * 是一种用于描述文本模式的特殊“代码”或“公式”。它能帮你更精确地匹配你想要的文本格式。
    * 如果您不熟悉正则表达式，可以暂时忽略此高级功能，或者通过以下资源学习：
        * **菜鸟教程 - 正则表达式 (中文入门):**
          [https://www.runoob.com/regexp/regexp-tutorial.html](https://www.runoob.com/regexp/regexp-tutorial.html)
        * **Python 官方 re 模块文档:**
          [https://docs.python.org/3/library/re.html](https://docs.python.org/3/library/re.html)
* **示例：确保玩家 ID 是数字**
    1. 源术语: `Player {{player_id:\d+}} disconnected.`
    2. 目标术语: `玩家 {{player_id}} 已断开连接。`

    * **效果:**
        * "Player 12345 disconnected." -> 匹配成功，翻译为 "玩家 12345 已断开连接。"
        * "Player abc disconnected." -> **不匹配**此规则。

**管理现有规则**

* **选中:** **单击**列表中的任意一条规则即可**选中**它。选中规则的内容会自动填充到上方的输入框中，以便修改。
* **修改:**
    1. 单击选中您想修改的规则。
    2. 直接在上方输入框中修改`源术语`或`目标术语`。
    3. 点击`添加/更新术语`按钮。系统将使用输入框中的内容更新您原来选中的那条规则。
* **删除:**
    1. 单击选中您想删除的规则。
    2. 点击`删除选中术语`按钮。
* **清空:** 点击`清空术语`按钮将删除列表中的所有规则。

所有更改（添加、更新、删除）在操作后会立即生效并自动保存。